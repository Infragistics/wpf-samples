<igwpf:XamRibbonWindow x:Class="IgExcel.Shell"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:ig="http://schemas.infragistics.com/xaml"
        xmlns:igwpf="http://schemas.infragistics.com/xaml/wpf"
        xmlns:prism="http://www.codeplex.com/prism"      
        xmlns:views="clr-namespace:IgExcel.Views"
        xmlns:i="clr-namespace:System.Windows.Interactivity;assembly=System.Windows.Interactivity"
        xmlns:behaviours="clr-namespace:IgExcel.Infrastructure.Behaviours;assembly=IgExcel.Infrastructure"
        xmlns:igPrim="http://schemas.infragistics.com/xaml/primitives"
        xmlns:converters="clr-namespace:IgExcel.Converters"
        xmlns:shell="clr-namespace:IgExcel"
    	xmlns:sys="clr-namespace:System;assembly=mscorlib"
        xmlns:adapters="clr-namespace:IgExcel.Infrastructure.Adapters;assembly=IgExcel.Infrastructure"
        xmlns:ap="clr-namespace:IgExcel.Infrastructure.AttachedProperties;assembly=IgExcel.Infrastructure"
        xmlns:infr="clr-namespace:IgExcel.Infrastructure;assembly=IgExcel.Infrastructure"
        xmlns:resources="clr-namespace:IgExcel.ResourceStrings"
        Icon="Images\Icons\IgExcelGray.ico"
        Title="{Binding Title}" Height="350" Width="525">
    <igwpf:XamRibbonWindow.InputBindings>
        <KeyBinding Modifiers="Control" Key="S" Command="{Binding SaveDocumentCommand}"/>
        <KeyBinding Modifiers="Control" Key="N" Command="{Binding CreateNewDocumentCommand}"/>
        <KeyBinding Modifiers="Ctrl+Shift" Key="F" Command="{Binding ShowFontSettingsDialogCommand}" CommandParameter="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat}"/>
    </igwpf:XamRibbonWindow.InputBindings>
    <igwpf:XamRibbonWindow.Resources>

        <!-- ================================== Converters ================================== -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>
        <converters:TwipsToPointsConverter x:Key="TwipsToPointsConverter"/>
        <converters:InvertedBooleanConverter x:Key="InvertedBooleanConverter"/>
        <converters:SplitVisibilityConverter x:Key="SplitVisibilityConverter"/>
        <converters:EmptyToBooleanConverter x:Key="EmptyToBooleanConverter"/>
        <converters:ValueToBooleanConverter x:Key="ValueToBooleanConverter"/>
        <converters:CellStyleConverter x:Key="CellStyleConverter"/>
        <converters:CellStateConverter x:Key="CellStateConverter"/>
        <converters:EndModeConverter x:Key="EndModeConverter"/>
        <converters:MagnificationConverter x:Key="MagnificationConverter"/>
        <converters:SelectionModeConverter x:Key="SelectionModeConverter"/>
        <converters:InvertedBooleanToVisibilityConverter x:Key="InvertedBooleanToVisibilityConverter"/>

        <igPrim:InverseBooleanConverter x:Key="inverseBooleanConverter" />

        <igPrim:ValueConverterGroup x:Key="excelDefaultBoolToBool">
            <igPrim:FixedValueConverter>
                <igPrim:FixedValueConverter.SourceValue>
                    <igwpf:ExcelDefaultableBoolean>True</igwpf:ExcelDefaultableBoolean>
                </igPrim:FixedValueConverter.SourceValue>
                <igPrim:FixedValueConverter.DestinationValue>
                    <sys:Boolean>True</sys:Boolean>
                </igPrim:FixedValueConverter.DestinationValue>
            </igPrim:FixedValueConverter>
            <igPrim:FixedValueConverter>
                <igPrim:FixedValueConverter.DestinationValue>
                    <sys:Boolean>False</sys:Boolean>
                </igPrim:FixedValueConverter.DestinationValue>
            </igPrim:FixedValueConverter>
        </igPrim:ValueConverterGroup>
        <!-- ================================== DataTemplates ================================== -->
        <DataTemplate x:Key="undoRedoToolItem">
            <TextBlock Text="{Binding ShortDescription}"  Margin="-30,-5" Padding="30,5">
                    <ig:Commanding.Command>
                        <ig:UndoManagerCommandSource EventName="MouseLeftButtonDown"  
                                                     CommandType="UndoRedoHistoryItem" 
                                                     ParameterBinding="{Binding }" />    
                    </ig:Commanding.Command>
            </TextBlock>
        </DataTemplate>

        <!-- ================================== Styles ================================== -->
        <Style x:Key="minimizeButton" TargetType="{x:Type ToggleButton}">
            <Setter Property="MinWidth" Value="30"></Setter>
            <Setter Property="MinHeight" Value="25"></Setter>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border x:Name="border" Background="#fff7f7f7" VerticalAlignment="{TemplateBinding VerticalAlignment}" HorizontalAlignment="{TemplateBinding HorizontalAlignment}" Margin="0,0,0,0" BorderThickness="0" igPrim:XamlHelper.SnapsToDevicePixels="True">
                            <Grid x:Name="grid" VerticalAlignment="Center" HorizontalAlignment="Center" Height="6" Width="11">
                                <Path x:Name="arrowShowMenu" Data="M 0,0 L 5,5 L 10,0" HorizontalAlignment="Center" Stroke="#6D6D6D" Opacity="0" RenderOptions.EdgeMode="Aliased"
                                          StrokeThickness="1" VerticalAlignment="Center" UseLayoutRounding="True"/>
                                <Path x:Name="arrowHideMenu" Data="M 0,5 L 5,0 L 10,5" HorizontalAlignment="Center" Stroke="#6D6D6D" RenderOptions.EdgeMode="Aliased"
                                          StrokeThickness="1" VerticalAlignment="Center" UseLayoutRounding="True"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="true">
                                <Setter Property="Opacity" Value="1" TargetName="arrowShowMenu" />
                                <Setter Property="Opacity" Value="0" TargetName="arrowHideMenu" />
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter Property="Background" TargetName="border" Value="#ffffffff" />
                                <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" TargetName="border" />
                            </Trigger>
                            <Trigger Property="IsPressed" Value="true">
                                <Setter Property="Opacity" Value="0.5" TargetName="border" />
                            </Trigger>

                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"></Condition>
                                    <Condition Property="IsChecked" Value="False"></Condition>
                                </MultiTrigger.Conditions>
                                <MultiTrigger.Setters>
                                    <Setter Property="Margin" TargetName="border" Value="0,0,0,-1" />
                                    <Setter Property="BorderThickness" Value="1,1,1,0" TargetName="border" />
                                    <Setter Property="Margin" Value="0,0,0,1" TargetName="grid" />
                                    <Setter Property="ToolTip">
                                        <Setter.Value>
                                            <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_MinimizeRibbon_Header}" Padding="4,0,0,0" FooterSeparatorVisibility="Collapsed"
                                                                      Content="{x:Static resources:ResourceStrings.Text_MinimizeRibbon_Content}"/>
                                        </Setter.Value>
                                    </Setter>
                                </MultiTrigger.Setters>
                            </MultiTrigger>

                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"></Condition>
                                    <Condition Property="IsChecked" Value="True"></Condition>
                                </MultiTrigger.Conditions>
                                <MultiTrigger.Setters>
                                    <Setter Property="BorderThickness" Value="1,1,1,1" TargetName="border" />
                                    <Setter Property="BorderBrush" Value="{StaticResource BorderBrush}" TargetName="border" />
                                    <Setter Property="Margin" TargetName="border" Value="0,0,0,1" />
                                    <Setter Property="Margin" Value="0,1,0,0" TargetName="grid" />
                                    <Setter Property="ToolTip">
                                        <Setter.Value>
                                            <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_ExpandRibbon_Header}" Padding="4,0,0,0" FooterSeparatorVisibility="Collapsed"
                                                                  Content="{x:Static resources:ResourceStrings.Text_ExpandRibbon_Content}"/>
                                        </Setter.Value>
                                    </Setter>
                                </MultiTrigger.Setters>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </igwpf:XamRibbonWindow.Resources>
    <Grid>
        <igwpf:RibbonWindowContentHost>
            <igwpf:RibbonWindowContentHost.Ribbon>
                <!-- ================================== Ribbon ================================== -->
                <igwpf:XamRibbon Name="xamRibbon1" ApplicationMenuMode="Office2010" Theme="Office2013" ApplicationAccentColor="#217346" ig:Commanding.CommandTarget="{Binding ElementName=spreadSheet}">
                    <igwpf:XamRibbon.QuickAccessToolbar>
                        <!-- ================================== QuickAccessToolbar ================================== -->
                        <igwpf:QuickAccessToolbar>
                            <igwpf:QatPlaceholderTool TargetId="saveTool"/>
                            <igwpf:QatPlaceholderTool TargetId="undoTool"/>
                            <igwpf:QatPlaceholderTool TargetId="redoTool"/>
                        </igwpf:QuickAccessToolbar>
                    </igwpf:XamRibbon.QuickAccessToolbar>
                    <igwpf:XamRibbon.TabItemAreaToolbar>
                        <!-- ================================== TabItemAreaToolbar ================================== -->
                        <igwpf:TabItemAreaToolbar>
                            <StackPanel Orientation="Horizontal" Margin="0,0,18,0">
                                <ToggleButton Cursor="Hand" Name="btnUserInfo" ClickMode="Press">
                                    <ToggleButton.Template>
                                        <ControlTemplate TargetType="{x:Type ToggleButton}">
                                            <StackPanel Name="btnUserInfoContainer" Orientation="Horizontal" Background="#fff7f7f7" Margin="0,0,5,0">
                                                <Image Source="/IgExcel;component/Images/UserPhoto.jpg"  Width="23" Height="23" Margin="0,1,8,0"/>
                                                <TextBlock VerticalAlignment="Center" Name="tbUserName" Text="{x:Static resources:ResourceStrings.Ig_UserName_String}" Foreground="{StaticResource DarkTextBrush}" Margin="0,0,10,0" />
                                            </StackPanel>
                                            <ControlTemplate.Triggers>
                                                <Trigger Property="IsChecked" Value="true">
                                                    <Setter Property="Background" TargetName="btnUserInfoContainer" Value="#ffffffff" />
                                                </Trigger>
                                                <Trigger Property="IsPressed" Value="true">
                                                    <Setter Property="Opacity" TargetName="btnUserInfoContainer" Value="0.5" />
                                                </Trigger>
                                                <MultiTrigger>
                                                    <MultiTrigger.Conditions>
                                                        <Condition Property="IsMouseOver" Value="True"></Condition>
                                                        <Condition Property="IsChecked" Value="False"></Condition>
                                                    </MultiTrigger.Conditions>
                                                    <MultiTrigger.Setters>
                                                        <Setter Property="Background" TargetName="btnUserInfoContainer" Value="#ffffffff" />
                                                    </MultiTrigger.Setters>
                                                </MultiTrigger>
                                            </ControlTemplate.Triggers>
                                        </ControlTemplate>
                                    </ToggleButton.Template>
                                </ToggleButton>
                                <ToggleButton Style="{StaticResource minimizeButton}" IsChecked="{Binding ElementName=xamRibbon1,Path=IsMinimized}" Visibility="{Binding ElementName=applicationMenu2010, Path=IsOpen, Converter={StaticResource InvertedBooleanToVisibilityConverter}}"/>
                                <Popup Name="popupUserInfo" Width="300" Height="160" PopupAnimation="Slide"
                                       IsOpen="{Binding ElementName=btnUserInfo, Path=IsChecked}"
                                       StaysOpen="{Binding ElementName=btnUserInfo, Path=IsMouseOver}"
                                       PlacementTarget="{Binding ElementName=btnUserInfo}" Placement="Bottom">
                                    <Border BorderBrush="{StaticResource LineBrush}" BorderThickness="1" Background="White">
                                        <StackPanel Margin="20">
                                            <StackPanel Orientation="Horizontal">
                                                <Border Width="50" Height="50" Margin="0,0,20,18" HorizontalAlignment="Left" VerticalAlignment="Top">
                                                    <Image Source="/IgExcel;component/Images/UserPhoto.jpg"/>
                                                </Border>
                                                <StackPanel>
                                                    <TextBlock Foreground="{StaticResource LightTextBrush}" FontSize="18" Text="{x:Static resources:ResourceStrings.Ig_UserName_String}" Margin="0,0,0,1"/>
                                                    <TextBlock Foreground="{StaticResource LightTextBrush}" Text="{x:Static resources:ResourceStrings.Ig_UserEmail_String}"/>
                                                </StackPanel>
                                            </StackPanel>
                                            <Rectangle Height="1" Fill="{StaticResource LineBrush}" igPrim:XamlHelper.SnapsToDevicePixels="True" Margin="0"/>
                                            <StackPanel Orientation="Horizontal">
                                                <Border Margin="0,20,20,18" Width="100" Height="25" Background="{StaticResource AppDefaultBtnBackgrColor}" HorizontalAlignment="Left">
                                                    <TextBlock Foreground="{StaticResource ApplicationAccentColor}" Text="{x:Static resources:ResourceStrings.Text_AccountSeetings}" FontSize="11" HorizontalAlignment="Center" Margin="4" />
                                                </Border>
                                                <Border Margin="27,20,0,18" Width="110" Height="25" Background="{StaticResource AppDefaultBtnBackgrColor}">
                                                    <TextBlock Foreground="{StaticResource ApplicationAccentColor}" Text="{x:Static resources:ResourceStrings.Text_SwitchAccount}" FontSize="11" HorizontalAlignment="Center" Margin="4"/>
                                                </Border>
                                            </StackPanel>
                                        </StackPanel>
                                    </Border>
                                </Popup>
                            </StackPanel>
                        </igwpf:TabItemAreaToolbar>
                    </igwpf:XamRibbon.TabItemAreaToolbar>
                    <!-- ================================== ApplicationMenu2010 ================================== -->
                    <igwpf:XamRibbon.ApplicationMenu2010>
                        <igwpf:ApplicationMenu2010 Caption="{x:Static resources:ResourceStrings.Text_FILE}" 
                                                   IsOpen="{Binding IsBackstageOpened, Mode=TwoWay}" 
                                                   ap:ApplicationMenu2010Properties.SelectedItemName="{Binding SelectedBackstageMenuItem, Mode=TwoWay}" 
                                                   Name="applicationMenu2010">
                            <igwpf:ApplicationMenu2010Item Header="{x:Static resources:ResourceStrings.Text_Info}" IsEnabled="{Binding IsUiPartEnabled}">
                                <views:InfoView  FileName="{Binding FileNameWithoutExtension, Mode=TwoWay}" DocumentProperties="{Binding ElementName=spreadSheet, Path=Workbook.DocumentProperties}" />
                            </igwpf:ApplicationMenu2010Item>
                            <igwpf:ApplicationMenu2010Item Header="{x:Static resources:ResourceStrings.Text_New}" Name="newTab">
                                <ContentControl prism:RegionManager.RegionName="NewDocumentRegion"/>
                            </igwpf:ApplicationMenu2010Item>
                            <igwpf:ApplicationMenu2010Item Header="{x:Static resources:ResourceStrings.Text_Open}">
                                <ContentControl prism:RegionManager.RegionName="OpenFileRegion"/>
                            </igwpf:ApplicationMenu2010Item>
                            <igwpf:ApplicationMenu2010Item Header="{x:Static resources:ResourceStrings.Text_Save}" Command="{Binding SaveDocumentCommand}" IsEnabled="{Binding IsUiPartEnabled}">
                                <Grid/>
                            </igwpf:ApplicationMenu2010Item>
                            <igwpf:ApplicationMenu2010Item Header="{x:Static resources:ResourceStrings.Text_SaveAs}" Name="saveAsTab" IsEnabled="{Binding IsUiPartEnabled}">
                                <ContentControl prism:RegionManager.RegionName="SaveFileRegion"/>
                            </igwpf:ApplicationMenu2010Item>
                            <igwpf:ApplicationMenu2010Item Header="{x:Static resources:ResourceStrings.Text_Close}" Command="{Binding CloseDocumentCommand}" IsEnabled="{Binding IsUiPartEnabled}"/>
                        </igwpf:ApplicationMenu2010>

                    </igwpf:XamRibbon.ApplicationMenu2010>
                    <igwpf:XamRibbon.Tabs>
                        <!-- ================================== Ribbon HOME Tab ================================== -->
                        <igwpf:RibbonTabItem Header="{x:Static resources:ResourceStrings.Text_HOME}">

                            <!-- ================================== Ribbon Clipboard RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Clipboard}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_Paste}"
                                                  Command="ApplicationCommands.Paste"
                                                  LargeImage="/IgExcel;component/Images/Paste_32x32.png" 
                                                  igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge">
                                    <igwpf:ButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Paste_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Paste_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ButtonTool.ToolTip>
                                </igwpf:ButtonTool>
                                <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_Cut}" 
                                                  Command="ApplicationCommands.Cut"
                                                  SmallImage="/IgExcel;component/Images/Cut_16x16.png" 
                                                  igwpf:RibbonGroup.MaximumSize="ImageAndTextNormal">
                                    <igwpf:ButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Cut_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Cut_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ButtonTool.ToolTip>
                                </igwpf:ButtonTool>
                                <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_Copy}" 
                                                  Command="ApplicationCommands.Copy"
                                                  SmallImage="/IgExcel;component/Images/Copy_16x16.png" igwpf:RibbonGroup.MaximumSize="ImageAndTextNormal">
                                    <igwpf:ButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Copy_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Copy_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ButtonTool.ToolTip>
                                </igwpf:ButtonTool>
                            </igwpf:RibbonGroup>

                            <!-- ================================== Ribbon Font RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Font}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:ToolHorizontalWrapPanel>
                                    <igwpf:ButtonGroup>
                                        <igwpf:ComboEditorTool IsEditable="True" ItemsSource="{Binding FontNames}"
                                                               SelectedItem="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Font.Name}"
                                                               IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                            <igwpf:ComboEditorTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Font_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_Font_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ComboEditorTool.ToolTip>
                                            <igwpf:ComboEditorTool.ComboBoxStyle>
                                                <Style TargetType="ComboBox">
                                                    <Setter Property="ItemTemplate">
                                                        <Setter.Value>
                                                            <DataTemplate>
                                                                <StackPanel Orientation="Horizontal">
                                                                    <Image VerticalAlignment="Center" Width="16" Height="16" Source="/IgExcel;component/Images/FontIcon.png" Margin="0,0,7,0" />
                                                                    <TextBlock Text="{Binding }" FontFamily="{Binding }" FontSize="12" Width="180"/>
                                                                </StackPanel>
                                                            </DataTemplate>
                                                        </Setter.Value>
                                                    </Setter>
                                                </Style>
                                            </igwpf:ComboEditorTool.ComboBoxStyle>
                                        </igwpf:ComboEditorTool>
                                        <igwpf:ComboEditorTool EditAreaWidth="45" IsEditable="True" ItemsSource="{Binding FontSizes}"
                                                               SelectedItem="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Font.Height, Converter={StaticResource TwipsToPointsConverter}}"
                                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                            <igwpf:ComboEditorTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FontSize_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_FontSize_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ComboEditorTool.ToolTip>
                                        </igwpf:ComboEditorTool>
                                        <igwpf:ButtonTool SmallImage="/IgExcel;component/Images/IncFont_16x16.png" Command="EditingCommands.IncreaseFontSize">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_IncreaseFontSize_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_IncreaseFontSize_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool SmallImage="/IgExcel;component/Images/DecFont_16x16.png" Command="EditingCommands.DecreaseFontSize">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_DecreaseFontSize_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_DecreaseFontSize_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                        </igwpf:ButtonTool>
                                    </igwpf:ButtonGroup>
                                    <igwpf:ButtonGroup>
                                        <igwpf:ToggleButtonTool SmallImage="/IgExcel;component/Images/Bold16.png" 
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Font.Bold, Mode=OneWay, Converter={StaticResource excelDefaultBoolToBool}}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="ToggleBold" EventName="Click"/>
                                            </ig:Commanding.Command>
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Bold_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_Bold_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                        <igwpf:ToggleButtonTool SmallImage="/IgExcel;component/Images/Italic16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Font.Italic, Mode=OneWay, Converter={StaticResource excelDefaultBoolToBool}}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="ToggleItalic" EventName="Click"/>
                                            </ig:Commanding.Command>
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Italic_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_Italic_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>

                                        <igwpf:SeparatorTool/>

                                        <igwpf:ToggleButtonTool SmallImage="/IgExcel;component/Images/strikeout_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Font.Strikeout, Mode=OneWay, Converter={StaticResource excelDefaultBoolToBool}}"
                                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="ToggleStrikeThrough" EventName="Click" />
                                            </ig:Commanding.Command>
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Strikethrough_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_Strikethrough_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>

                                        <igwpf:SeparatorTool/>

                                        <igwpf:MenuTool SmallImage="/IgExcel;component/Images/Borders/BottomBorder_16x16.png" ButtonType="Segmented" igwpf:RibbonGroup.MaximumSize="ImageOnly" 
                                                        Command="{Binding ElementName=selectionAdapter, Path=SetBorderCommand}"
                                                        DataContext="{Binding ElementName=selectionAdapter}"
                                                        ap:MenuToolProperties.EnableSelectionTracking="True"
                                                        IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                            <igwpf:MenuTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Borders_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_Borders_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:MenuTool.ToolTip>
                                            <igwpf:LabelTool Caption="{x:Static resources:ResourceStrings.Text_Borders}"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_BottomBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/BottomBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="BottomBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_TopBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/TopBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="TopBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_LeftBorder}"  
                                                              SmallImage="/IgExcel;component/Images/Borders/LeftBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="LeftBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_RightBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/RightBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="RightBorder"/>
                                            <igwpf:SeparatorTool/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_NoBorder}"  
                                                              SmallImage="/IgExcel;component/Images/Borders/NoBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="NoBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_AllBorders}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/AllBorders_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="AllBorders"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_OutsideBorders}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/OutsideBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="OutsideBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ThickBoxBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/ThickBoxBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="ThickBoxBorder"/>
                                            <igwpf:SeparatorTool/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_BottomDoubleBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/BottomDoubleBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="BottomDoubleBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ThickBottomBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/ThickBottomBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="ThickBottomBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_TopAndBottomBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/TopAndBottomBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="TopAndBottomBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_TopAndThickBottomBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/TopAndThickBottomBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="TopAndThickBottomBorder"/>
                                            <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_TopAndDoubleBottomBorder}" 
                                                              SmallImage="/IgExcel;component/Images/Borders/TopAndDoubleBottomBorder_16x16.png"
                                                              Command="{Binding SetBorderCommand}" CommandParameter="TopAndDoubleBottomBorder"/>
                                        </igwpf:MenuTool>

                                        <igwpf:SeparatorTool/>

                                        <infr:ColorPickerTool Image="/IgExcel;component/Images/fill_16x16.png" 
                                                              SelectedColor="{Binding ElementName=selectionAdapter, Path=FillColor, Mode=TwoWay}"
                                                              Command="{Binding ElementName=selectionAdapter, Path=SetCellFillCommand}" 
                                                              CommandParameter="{Binding ElementName=selectionAdapter, Path=FillColor}"
                                                              UndoManager="{Binding ElementName=spreadSheet, Path=UndoManager}"
                                                              TransparentColorItemText="{x:Static resources:ResourceStrings.Text_NoColor}"
                                                              IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                            <infr:ColorPickerTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FillColor_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_FillColor_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </infr:ColorPickerTool.ToolTip>
                                        </infr:ColorPickerTool>
                                        <infr:ColorPickerTool Image="/IgExcel;component/Images/FontColor_16x16.png" 
                                                              SelectedColor="{Binding ElementName=selectionAdapter, Path=ForegroundColor, Mode=TwoWay}"
                                                              Command="{Binding ElementName=selectionAdapter, Path=SetFontColorCommand}" 
                                                              CommandParameter="{Binding ElementName=selectionAdapter, Path=ForegroundColor}"
                                                              UndoManager="{Binding ElementName=spreadSheet, Path=UndoManager}"
                                                              TransparentColorItemText="{x:Static resources:ResourceStrings.Text_Automatic}"
                                                              IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                            <infr:ColorPickerTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FontColor_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_FontColor_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </infr:ColorPickerTool.ToolTip>
                                        </infr:ColorPickerTool>
                                    </igwpf:ButtonGroup>
                                </igwpf:ToolHorizontalWrapPanel>
                                <igwpf:RibbonGroup.DialogBoxLauncherTool>
                                    <igwpf:ButtonTool Command="{Binding ShowFontSettingsDialogCommand}" CommandParameter="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat}">
                                        <igwpf:ButtonTool.ToolTip>
                                            <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FontGroup_Description_Header}"
                                                                      ContentImage="/IgExcel;component/Images/FontSettings_Preview.png"
                                                                      Content="{x:Static resources:ResourceStrings.Text_FontGroup_Description_Content}"
                                                                      FooterSeparatorVisibility="Hidden"/>
                                        </igwpf:ButtonTool.ToolTip>
                                    </igwpf:ButtonTool>
                                </igwpf:RibbonGroup.DialogBoxLauncherTool>
                            </igwpf:RibbonGroup>

                            <!-- ================================== Ribbon Alignment RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Alignment}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:ToolHorizontalWrapPanel>
                                    <igwpf:ButtonGroup>
                                        <igwpf:ToggleButtonTool SmallImage="/IgExcel;component/Images/TopAlign_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.VerticalAlignment, Mode=OneWay, Converter={StaticResource ValueToBooleanConverter}, ConverterParameter='Top'}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="AlignVerticalTop" EventName="Click"/>
                                            </ig:Commanding.Command>
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_TopAlign_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_TopAlign_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                        <igwpf:ToggleButtonTool SmallImage="/IgExcel;component/Images/CenterAlign_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.VerticalAlignment, Mode=OneWay, Converter={StaticResource ValueToBooleanConverter}, ConverterParameter='Center'}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="AlignVerticalMiddle" EventName="Click"/>
                                            </ig:Commanding.Command>
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_MiddleAlign_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_MiddleAlign_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                        <igwpf:ToggleButtonTool SmallImage="/IgExcel;component/Images/BottomAlign_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.VerticalAlignment, Mode=OneWay, Converter={StaticResource ValueToBooleanConverter}, ConverterParameter='Bottom'}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="AlignVerticalBottom" EventName="Click"/>
                                            </ig:Commanding.Command>
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_BottomAlign_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_BottomAlign_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                    </igwpf:ButtonGroup>
                                    <igwpf:ButtonGroup>
                                        <igwpf:ToggleButtonTool Command="EditingCommands.AlignLeft" 
                                                                SmallImage="/IgExcel;component/Images/left_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Alignment, Mode=OneWay, Converter={StaticResource ValueToBooleanConverter}, ConverterParameter='Left'}">
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_AlignLeft_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_AlignLeft_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                        <igwpf:ToggleButtonTool Command="EditingCommands.AlignCenter" 
                                                                SmallImage="/IgExcel;component/Images/center_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Alignment, Mode=OneWay, Converter={StaticResource ValueToBooleanConverter}, ConverterParameter='Center'}">
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Center_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_Center_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                        <igwpf:ToggleButtonTool Command="EditingCommands.AlignRight" 
                                                                SmallImage="/IgExcel;component/Images/right_16x16.png"
                                                                IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.Alignment, Mode=OneWay, Converter={StaticResource ValueToBooleanConverter}, ConverterParameter='Right'}">
                                            <igwpf:ToggleButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_AlignRight_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_AlignRight_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ToggleButtonTool.ToolTip>
                                        </igwpf:ToggleButtonTool>
                                        <igwpf:SeparatorTool/>
                                        <igwpf:ButtonTool Command="EditingCommands.DecreaseIndentation" SmallImage="/IgExcel;component/Images/indentleft_16x16.png">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_DecreaseIndent_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_DecreaseIndent_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Command="EditingCommands.IncreaseIndentation" SmallImage="/IgExcel;component/Images/indentright_16x16.png">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_IncreaseIndent_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_IncreaseIndent_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                        </igwpf:ButtonTool>
                                    </igwpf:ButtonGroup>
                                </igwpf:ToolHorizontalWrapPanel>
                                <igwpf:SeparatorTool/>
                                <igwpf:ToolHorizontalWrapPanel>
                                    <igwpf:ToggleButtonTool Caption="{x:Static resources:ResourceStrings.Text_WrapText}" 
                                                            IsChecked="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat.WrapText, Mode=OneWay, Converter={StaticResource excelDefaultBoolToBool}}"
                                                            SmallImage="/IgExcel;component/Images/WrapText_16x16.png" igwpf:RibbonGroup.MaximumSize="ImageAndTextNormal">
                                        <igwpf:ToggleButtonTool.ToolTip>
                                            <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_WrapText_Header}"
                                                                      ContentImage="/IgExcel;component/Images/WrapText_Tooltip.png"
                                                                      Content="{x:Static resources:ResourceStrings.Text_WrapText_Content}"
                                                                      FooterSeparatorVisibility="Hidden"/>
                                        </igwpf:ToggleButtonTool.ToolTip>
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="ToggleWrapText" EventName="Click"  />
                                        </ig:Commanding.Command>
                                    </igwpf:ToggleButtonTool>
                                    <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_MergeAndCenter}" ButtonType="Segmented" 
                                                    SmallImage="/IgExcel;component/Images/MergeCellsAndCenter_16x16.png" igwpf:RibbonGroup.MaximumSize="ImageAndTextNormal">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="MergeCellsAndCenter" EventName="Click"/>
                                        </ig:Commanding.Command>
                                        <igwpf:MenuTool.ToolTip>
                                            <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_MergeAndCenter_Header}"
                                                                      ContentImage="/IgExcel;component/Images/MergeAndCenter_Tooltip.png"
                                                                      Content="{x:Static resources:ResourceStrings.Text_MergeAndCenter_Content}"
                                                                      FooterSeparatorVisibility="Hidden"/>
                                        </igwpf:MenuTool.ToolTip>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_MergeAndCenter}"
                                                          SmallImage="/IgExcel;component/Images/MergeCellsAndCenter_16x16.png">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_MergeAndCenter_Header}"
                                                                          ContentImage="/IgExcel;component/Images/MergeAndCenter_Tooltip.png"
                                                                          Content="{x:Static resources:ResourceStrings.Text_MergeAndCenter_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="MergeCellsAndCenter" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_MergeAcross}"
                                                          SmallImage="/IgExcel;component/Images/MergeAcross_16x16.png">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_MergeAcross_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_MergeAcross_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="MergeCellsAcross" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_MergeCells}"
                                                          SmallImage="/IgExcel;component/Images/MergeCells_16x16.png">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_MergeCells_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_MergeCells_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="MergeCells" EventName="Click"  />
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_UnmergeCells}"
                                                          SmallImage="/IgExcel;component/Images/UnmergeCells_16x16.png">
                                            <igwpf:ButtonTool.ToolTip>
                                                <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_UnmergeCells_Header}"
                                                                          Content="{x:Static resources:ResourceStrings.Text_UnmergeCells_Content}"
                                                                          FooterSeparatorVisibility="Hidden"/>
                                            </igwpf:ButtonTool.ToolTip>
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="UnmergeCells" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                    </igwpf:MenuTool>
                                </igwpf:ToolHorizontalWrapPanel>
                                <igwpf:RibbonGroup.DialogBoxLauncherTool>
                                    <igwpf:ButtonTool Command="{Binding ShowAlignmnetSettingsDialogCommand}" CommandParameter="{Binding ElementName=spreadSheet, Path=ActiveSelectionCellRangeFormat}">
                                        <igwpf:ButtonTool.ToolTip>
                                            <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_AlignmentGroup_Description_Header}"
                                                                      ContentImage="/IgExcel;component/Images/AlignmentSettings_Preview.png"
                                                                      Content="{x:Static resources:ResourceStrings.Text_AlignmentGroup_Description_Content}"
                                                                      FooterSeparatorVisibility="Hidden"/>
                                        </igwpf:ButtonTool.ToolTip>
                                    </igwpf:ButtonTool>
                                </igwpf:RibbonGroup.DialogBoxLauncherTool>
                            </igwpf:RibbonGroup>

                            <!-- ================================== Ribbon Styles RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Styles}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_FormatAsTable}"  ButtonType="DropDown"
                                                DataContext="{Binding ElementName=selectionAdapter}"
                                                IsEnabled="{Binding CanExecuteFormatAsTable, Mode=OneWay}"
                                                LargeImage="/IgExcel;component/Images/FormatAsTable_32x32.png" 
                                                igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge">
                                    <igwpf:GalleryTool MaxDropDownColumns="7" MinDropDownColumns="7" ItemBehavior="StateButton" AllowResizeDropDown="False">
                                        <igwpf:GalleryTool.ItemSettings>
                                            <igwpf:GalleryItemSettings TextDisplayMode="Never"/>
                                        </igwpf:GalleryTool.ItemSettings>
                                        <i:Interaction.Behaviors>
                                            <behaviours:GalleryToolBehavior ItemsSource="{Binding AllTableStyles}" 
                                                                            SelectedItemKey="{Binding TableStyle, Mode=TwoWay}"
                                                                            ImagesPath="/Images/Tables/"/>
                                        </i:Interaction.Behaviors>
                                        <igwpf:GalleryTool.Groups>
                                            <igwpf:GalleryItemGroup behaviours:GalleryItemSelected.Command="{Binding Parent.DataContext.FormatAsTableCommand}"  Title="{x:Static resources:ResourceStrings.Text_Light}" behaviours:GalleryToolBehavior.GroupKeys="{Binding LightTableStyles}"/>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_Medium}" behaviours:GalleryToolBehavior.GroupKeys="{Binding MediumTableStyles}"/>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_Dark}" behaviours:GalleryToolBehavior.GroupKeys="{Binding DarkTableStyles}"/>
                                        </igwpf:GalleryTool.Groups>
                                    </igwpf:GalleryTool>
                                    <igwpf:MenuTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FormatAsTable_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_FormatAsTable_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:MenuTool.ToolTip>
                                </igwpf:MenuTool>

                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_CellStyles}" ButtonType="DropDown"
                                                ShouldDisplayGalleryPreview="True"
                                                DataContext="{Binding ElementName=spreadSheet}"
                                                LargeImage="/IgExcel;component/Images/CellStyles_32x32.png" 
                                                igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge"
                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:GalleryTool MaxDropDownColumns="6" MinDropDownColumns="6" ItemBehavior="StateButton" AllowResizeDropDown="False"  MaxPreviewColumns="5" MinPreviewColumns="2">
                                        <igwpf:GalleryTool.ItemSettings>
                                            <igwpf:GalleryItemSettings TextDisplayMode="Never"/>
                                        </igwpf:GalleryTool.ItemSettings>
                                        <i:Interaction.Behaviors>
                                            <behaviours:GalleryToolBehavior ItemsSource="{Binding Parent.DataContext.CellStyles}" 
                                                                            ImagesPath="/Images/Cells/">
                                                <behaviours:GalleryToolBehavior.SelectedItemKey>
                                                    <MultiBinding Converter="{StaticResource CellStyleConverter}" Mode="TwoWay">
                                                        <Binding Path="ActiveSelectionCellRangeFormat.Style" Mode="TwoWay"/>
                                                        <Binding Path="Workbook.Styles" Mode="OneWay"/>
                                                    </MultiBinding>
                                                </behaviours:GalleryToolBehavior.SelectedItemKey>
                                            </behaviours:GalleryToolBehavior>
                                        </i:Interaction.Behaviors>
                                        <igwpf:GalleryTool.Groups>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_GoodBadAndNeutral}"
                                                                    behaviours:GalleryToolBehavior.GroupKeys="{Binding Parent.DataContext.GoodBadAndNeutralCellStyles}"/>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_DataAndModel}"
                                                                    behaviours:GalleryToolBehavior.GroupKeys="{Binding Parent.DataContext.DataAndModelCellStyles}"/>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_TitlesAndHeadings}"
                                                                    behaviours:GalleryToolBehavior.GroupKeys="{Binding Parent.DataContext.TitlesAndHeadingsCellStyles}"/>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_ThemedCellStyles}"
                                                                    behaviours:GalleryToolBehavior.GroupKeys="{Binding Parent.DataContext.ThemedCellStyles}"/>
                                            <igwpf:GalleryItemGroup Title="{x:Static resources:ResourceStrings.Text_NumberFormat}"
                                                                    behaviours:GalleryToolBehavior.GroupKeys="{Binding Parent.DataContext.NumberFormatCellStyles}"/>
                                        </igwpf:GalleryTool.Groups>
                                    </igwpf:GalleryTool>
                                    <igwpf:MenuTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_CellStyle_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_CellStyle_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:MenuTool.ToolTip>
                                </igwpf:MenuTool>
                            </igwpf:RibbonGroup>
                            <!-- ================================== Ribbon Cells RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Cells}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_Insert}" ButtonType="DropDown"
                                                LargeImage="/IgExcel;component/Images/Insert_32x32.png" 
                                                igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge"
                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_InsertCells}" ButtonType="DropDown"
                                                    LargeImage="/IgExcel;component/Images/InsertCells_16x16.png">
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ShiftCellsRight}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="InsertCellsShiftRight" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ShiftCellsDown}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="InsertCellsShiftDown" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_EntireRow}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="InsertRows" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_EntireColumn}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="InsertColumns" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                    </igwpf:MenuTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_InsertSheetRows}" 
                                                              SmallImage="/IgExcel;component/Images/InsertSheetRows_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="InsertRows" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_InsertSheetColumns}" 
                                                              SmallImage="/IgExcel;component/Images/InsertSheetColumns_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="InsertColumns" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:SeparatorTool/>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_InsertSheet}" 
                                                              SmallImage="/IgExcel;component/Images/InsertSheet_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="InsertNewWorksheets" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:MenuTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Insert_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Insert_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:MenuTool.ToolTip>
                                </igwpf:MenuTool>

                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_Delete}"  ButtonType="DropDown"
                                                LargeImage="/IgExcel;component/Images/Delete_32x32.png" 
                                                igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge"
                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">

                                    <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_DeleteCells}" ButtonType="DropDown"
                                                    LargeImage="/IgExcel;component/Images/DeleteCells_16x16.png">
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ShiftCellsLeft}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="DeleteCellsShiftLeft" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ShiftCellsUp}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="DeleteCellsShiftUp" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_EntireRow}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="DeleteRows" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_EntireColumn}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="DeleteColumns" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                    </igwpf:MenuTool>

                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_DeleteSheetRows}" 
                                                      SmallImage="/IgExcel;component/Images/DeleteSheetRows_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="DeleteRows" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_DeleteSheetColumns}" 
                                                              SmallImage="/IgExcel;component/Images/DeleteSheetColumns_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="DeleteColumns" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:SeparatorTool/>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_DeleteSheet}" 
                                                              SmallImage="/IgExcel;component/Images/DeleteSheet_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="DeleteWorksheets" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:MenuTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Delete_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Delete_Cntent}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:MenuTool.ToolTip>
                                </igwpf:MenuTool>

                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_Format}"  ButtonType="DropDown"
                                                LargeImage="/IgExcel;component/Images/Format_32x32.png" 
                                                igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge"
                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:LabelTool Caption="{x:Static resources:ResourceStrings.Text_CellSize}"/>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_RowHeight}" 
                                                      SmallImage="/IgExcel;component/Images/RowHeight_16x16.png"
                                                      Command="{Binding ShowDimensionDialogCommand}" 
                                                      CommandParameter="{x:Static shell:DimensionDialogMode.RowHeight}"/>

                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_AutoFitRowHeight}" >
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="AutoFitRowHeight" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:SeparatorTool/>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ColumnWidth}" 
                                                      SmallImage="/IgExcel;component/Images/ColumnWidth_16x16.png"
                                                      Command="{Binding ShowDimensionDialogCommand}" 
                                                      CommandParameter="{x:Static shell:DimensionDialogMode.ColumnWidth}"/>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_AutoFitColumnWidth}">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="AutoFitColumnWidth" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_DefaultWidth}"
                                                      Command="{Binding ShowDimensionDialogCommand}" 
                                                      CommandParameter="{x:Static shell:DimensionDialogMode.DeafaultWidth}"/>

                                    <igwpf:LabelTool Caption="{x:Static resources:ResourceStrings.Text_Visibility}"/>
                                    <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_HideAndUnhide}" ButtonType="DropDown">
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_HideRows}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="HideRows" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_HideColumns}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="HideColumns" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:SeparatorTool/>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_UnhideRows}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="UnhideRows" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                        <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_UnhideColumns}">
                                            <ig:Commanding.Command>
                                                <igPrim:SpreadsheetCommandSource CommandType="UnhideColumns" EventName="Click"/>
                                            </ig:Commanding.Command>
                                        </igwpf:ButtonTool>
                                    </igwpf:MenuTool>

                                    <igwpf:LabelTool Caption="{x:Static resources:ResourceStrings.Text_OrganizeSheets}"/>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_RenameSheet}">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="RenameWorksheet" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:MenuTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Format_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Format_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:MenuTool.ToolTip>
                                </igwpf:MenuTool>
                            </igwpf:RibbonGroup>


                            <!-- ================================== Ribbon UndoRedoGroup Collapsed RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="UndoRedoGroup" Visibility="Collapsed" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:MenuTool ItemsSource="{Binding ElementName=spreadSheet, Path=UndoManager.UndoHistory}" Id="undoTool" ButtonType="Segmented"
                                                SmallImage="/IgExcel;component/Images/Undo16.png" Caption="Undo" 
                                                ItemTemplate="{StaticResource undoRedoToolItem}"
                                                Command="ApplicationCommands.Undo" ToolTip="{Binding ElementName=spreadSheet, Path=UndoManager.TopUndoHistoryItem.LongDescription}"/>

                                <igwpf:MenuTool ItemsSource="{Binding ElementName=spreadSheet, Path=UndoManager.RedoHistory}" Id="redoTool" ButtonType="Segmented"
                                                SmallImage="/IgExcel;component/Images/Redo16.png" Caption="Redo" 
                                                ItemTemplate="{StaticResource undoRedoToolItem}"
                                                Command="ApplicationCommands.Redo" ToolTip="{Binding ElementName=spreadSheet, Path=UndoManager.TopRedoHistoryItem.LongDescription}"/>
                                <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_Save}" Id="saveTool"
                                                  SmallImage="/IgExcel;component/Images/Save_16x16.png" 
                                                  Command="{Binding SaveDocumentCommand}" />
                            </igwpf:RibbonGroup>
                        </igwpf:RibbonTabItem>

                        <!-- ================================== Ribbon Data Tab ================================== -->
                        <igwpf:RibbonTabItem Header="{x:Static resources:ResourceStrings.Text_DATA}">
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_DataTools}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_DataValidation}"
                                                ButtonType="Segmented"
                                                Command="{Binding ShowDataValidationDialogCommand}"
                                                IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}"
                                                LargeImage="/IgExcel;component/Images/DataValidation_32x32.png" 
                                                igwpf:RibbonGroup.MinimumSize="ImageAndTextNormal"
                                                igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge">
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_DataValidationDots}" 
                                                      SmallImage="/IgExcel;component/Images/DataValidation_16x16.png"
                                                      Command="{Binding ShowDataValidationDialogCommand}">
                                    </igwpf:ButtonTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_CircleInvalidData}" 
                                                      SmallImage="/IgExcel;component/Images/DataValidationCircle_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="CircleInvalidData" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ClearValidationCircles}" 
                                                      SmallImage="/IgExcel;component/Images/DataValidationClear_16x16.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource CommandType="ClearValidationCircles" EventName="Click"/>
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                </igwpf:MenuTool>
                            </igwpf:RibbonGroup>
                        </igwpf:RibbonTabItem>

                        <!-- ================================== Ribbon View Tab ================================== -->
                        <igwpf:RibbonTabItem Header="{x:Static resources:ResourceStrings.Text_VIEW}">

                            <!-- ================================== Ribbon Show RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Show}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:CheckBoxTool Caption="{x:Static resources:ResourceStrings.Text_Gridlines}" 
                                                    IsChecked="{Binding ElementName=spreadSheet, Path=AreGridlinesVisible}" 
                                                    IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:CheckBoxTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_ViewGridlines_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_ViewGridlines_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:CheckBoxTool.ToolTip>
                                </igwpf:CheckBoxTool>
                                <igwpf:CheckBoxTool Caption="{x:Static resources:ResourceStrings.Text_FormulaBar}" 
                                                    IsChecked="{Binding ElementName=spreadSheet, Path=IsFormulaBarVisible}"
                                                    IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:CheckBoxTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FormulaBar_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_FormulaBar_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:CheckBoxTool.ToolTip>
                                </igwpf:CheckBoxTool>
                                <igwpf:CheckBoxTool Caption="{x:Static resources:ResourceStrings.Text_Headings}" 
                                                    IsChecked="{Binding ElementName=spreadSheet, Path=AreHeadersVisible}"
                                                    IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:CheckBoxTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_ViewHeadings_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_ViewHeadings_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:CheckBoxTool.ToolTip>
                                </igwpf:CheckBoxTool>
                            </igwpf:RibbonGroup>
                            <!-- ================================== Ribbon Zoom RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Zoom}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_Zoom}" 
                                                  Command="{Binding ShowZoomDialogCommand}"
                                                  LargeImage="/IgExcel;component/Images/Zoom_32x32.png"
                                                  igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge"
                                                  IsEnabled="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay, Converter={StaticResource inverseBooleanConverter}}">
                                    <igwpf:ButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Zoom_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Zoom_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ButtonTool.ToolTip>
                                </igwpf:ButtonTool>
                                <igwpf:ButtonTool Caption="100%" 
                                                  LargeImage="/IgExcel;component/Images/100percent_32x32.png"
                                                  igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge">
                                    <ig:Commanding.Command>
                                        <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="ZoomTo100" />
                                    </ig:Commanding.Command>
                                    <igwpf:ButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_100Percent_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_100Percent_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ButtonTool.ToolTip>
                                </igwpf:ButtonTool>
                                <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_ZoomToSelection}" 
                                                  LargeImage="/IgExcel;component/Images/ZoomToSelection_32x32.png"
                                                  igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge">
                                    <ig:Commanding.Command>
                                        <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="ZoomToSelection" />
                                    </ig:Commanding.Command>
                                    <igwpf:ButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_ZoomToSelection_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_ZoomToSelection_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ButtonTool.ToolTip>
                                </igwpf:ButtonTool>
                            </igwpf:RibbonGroup>

                            <!-- ================================== Ribbon Window RibbonGroup ================================== -->
                            <igwpf:RibbonGroup Caption="{x:Static resources:ResourceStrings.Text_Window}" IsEnabled="{Binding IsUiPartEnabled}">
                                <igwpf:MenuTool Caption="{x:Static resources:ResourceStrings.Text_FreezePanes}" UseLargeImages="True"
                                                LargeImage="/IgExcel;component/Images/FreezePanes_32x32.png"
                                                igwpf:RibbonGroup.MinimumSize="ImageAndTextLarge" igwpf:RibbonGroup.MaximumSize="ImageAndTextLarge">
                                    <igwpf:ButtonTool LargeImage="/IgExcel;component/Images/FreezePanes_32x32.png" Height="32"
                                                      igwpf:MenuToolBase.MenuItemDescription="{x:Static resources:ResourceStrings.Text_FreezePanes_Description}">
                                        <igwpf:ButtonTool.Style>
                                            <Style TargetType="{x:Type igwpf:ButtonTool}">
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding ElementName=spreadSheet, Path=Workbook.WindowOptions.SelectedWorksheet.DisplayOptions.PanesAreFrozen, Mode=OneWay}" Value="True">
                                                        <Setter Property="Caption" Value="{x:Static resources:ResourceStrings.Text_UnfreezePanes}" />
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding ElementName=spreadSheet, Path=Workbook.WindowOptions.SelectedWorksheet.DisplayOptions.PanesAreFrozen, Mode=OneWay}" Value="False">
                                                        <Setter Property="Caption" Value="{x:Static resources:ResourceStrings.Text_FreezePanes}" />
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </igwpf:ButtonTool.Style>
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="ToggleFreezePanes" />
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>
                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_FreezeTopRows}"
                                                      igwpf:MenuToolBase.MenuItemDescription="{x:Static resources:ResourceStrings.Text_FreezeTopRows_Description}"
                                                      LargeImage="/IgExcel;component/Images/FreezeTopRow_32x32.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="FreezeFirstRow" />
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>

                                    <igwpf:ButtonTool Caption="{x:Static resources:ResourceStrings.Text_FreezeFirstColumn}"
                                                      igwpf:MenuToolBase.MenuItemDescription="{x:Static resources:ResourceStrings.Text_FreezeFirstColumn_Description}"
                                                      LargeImage="/IgExcel;component/Images/FreezeFirstColumn_32x32.png">
                                        <ig:Commanding.Command>
                                            <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="FreezeFirstColumn" />
                                        </ig:Commanding.Command>
                                    </igwpf:ButtonTool>

                                    <igwpf:MenuTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_FreezePanes_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_FreezePanes_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:MenuTool.ToolTip>
                                </igwpf:MenuTool>
                                <igwpf:ToggleButtonTool Caption="{x:Static resources:ResourceStrings.Text_Split}"
                                                        SmallImage="/IgExcel;component/Images/Split_16x16.png" 
                                                        igwpf:RibbonGroup.MaximumSize="ImageAndTextNormal">
                                    <igwpf:ToggleButtonTool.IsChecked>
                                        <MultiBinding Converter="{StaticResource SplitVisibilityConverter}" Mode="OneWay">
                                            <Binding Path="Workbook.WindowOptions.SelectedWorksheet.DisplayOptions.UnfrozenPaneSettings.LeftPaneWidth" Mode="OneWay"/>
                                            <Binding Path="Workbook.WindowOptions.SelectedWorksheet.DisplayOptions.UnfrozenPaneSettings.TopPaneHeight" Mode="OneWay"/>
                                        </MultiBinding>
                                    </igwpf:ToggleButtonTool.IsChecked>
                                    <ig:Commanding.Command>
                                        <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="ToggleSplitPanes" />
                                    </ig:Commanding.Command>
                                    <igwpf:ToggleButtonTool.ToolTip>
                                        <igwpf:XamRibbonScreenTip Header="{x:Static resources:ResourceStrings.Text_Split_Header}"
                                                                  Content="{x:Static resources:ResourceStrings.Text_Split_Content}"
                                                                  FooterSeparatorVisibility="Hidden"/>
                                    </igwpf:ToggleButtonTool.ToolTip>
                                </igwpf:ToggleButtonTool>
                            </igwpf:RibbonGroup>
                        </igwpf:RibbonTabItem>

                    </igwpf:XamRibbon.Tabs>

                </igwpf:XamRibbon>
            </igwpf:RibbonWindowContentHost.Ribbon>

            <!-- ================================= Content ================================= -->
            <Grid Name="ContentGrid" Background="Silver">
                
                <!-- ================================== | XamSpreadsheet | ================================== -->
                <ig:XamSpreadsheet Name="spreadSheet" BorderThickness="1,0,1,1" 
                                   ActiveWorksheet="{Binding ActiveWorksheet, Mode=TwoWay}"
                                   Workbook="{Binding Workbook, Mode=TwoWay}"
                                   ZoomLevel="{Binding ZoomLevel, Mode=TwoWay}"
                                   Visibility="{Binding IsSpreadSheetVisible, Converter={StaticResource BooleanToVisibilityConverter}}"/>

                <adapters:SpreadSelectionSheetAdapter Name="selectionAdapter"
                                                      SpreadSheet="{Binding ElementName=spreadSheet}"
                                                      Selection="{Binding Selection, Mode=OneWayToSource}"
                                                      SelectedTable="{Binding SelectedTable, Mode=TwoWay}"
                                                      WorkbookDirtied="{Binding WorkbookDirtied, Mode=TwoWay}"
                                                      TrackChanges="{Binding TrackChanges, Mode=TwoWay}"
                                                      CanExecuteFormatAsTable="{Binding CanExecuteFormatAsTable, Mode=OneWayToSource}"
                                                      IsInEditModeIn="{Binding ElementName=spreadSheet, Path=IsInEditMode, Mode=OneWay}"
                                                      IsInEditModeOut="{Binding Path=IsInEditMode, Mode=OneWayToSource}" />

            </Grid>

            <!-- ================================= StatusBar ================================= -->
            <igwpf:RibbonWindowContentHost.StatusBar>
                <StatusBar x:Name="statusBar"  IsEnabled="{Binding IsUiPartEnabled}">
                    <StatusBar.ItemsPanel>
                        <ItemsPanelTemplate>
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>
                            </Grid>
                        </ItemsPanelTemplate>
                    </StatusBar.ItemsPanel>
                    <StatusBarItem Grid.Row="0" HorizontalAlignment="Left" Margin="5,0,0,0">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="{Binding ElementName=spreadSheet, Path=CellEditMode, Converter={StaticResource CellStateConverter}}"/>
                            <TextBlock Text="{Binding ElementName=spreadSheet, Path=IsInEndMode, Converter={StaticResource EndModeConverter}}" Margin="20,0,0,0"/>
                            <TextBlock Text="{Binding ElementName=spreadSheet, Path=SelectionMode, Converter={StaticResource SelectionModeConverter}}" Margin="20,0,0,0"/>
                        </StackPanel>
                    </StatusBarItem>

                    <StatusBarItem Grid.Row="1" HorizontalAlignment="Right">
                        <StackPanel Orientation="Horizontal">
                            <RepeatButton Width="10" Height="10" ig:Commanding.CommandTarget="{Binding ElementName=spreadSheet}">
                                <ig:Commanding.Command>
                                    <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="ZoomOut" />
                                </ig:Commanding.Command>
                                <RepeatButton.Template>
                                    <ControlTemplate>
                                        <Grid Width="10" Height="10" Background="Transparent">
                                            <Path Fill="White" Stretch="Fill" Width="8" Height="2" Data="M448.83333,332 L496.16665,332.00034 496.16666,347.00067 448.83334,347.00036 z" igPrim:XamlHelper.SnapsToDevicePixels="True"/>
                                        </Grid>
                                    </ControlTemplate>
                                </RepeatButton.Template>
                            </RepeatButton>
                            <Slider Width="150" Minimum="0" Maximum="100" SmallChange="1" LargeChange="5" VerticalAlignment="Center" Value="{Binding Path=ZoomLevel, ElementName=spreadSheet, IsAsync=True, Converter={StaticResource MagnificationConverter}}" Style="{StaticResource IGExcelSliderStyle}"/>

                            <RepeatButton Width="10" Height="10" ig:Commanding.CommandTarget="{Binding ElementName=spreadSheet}">
                                <ig:Commanding.Command>
                                    <igPrim:SpreadsheetCommandSource EventName="Click" CommandType="ZoomIn" />
                                </ig:Commanding.Command>
                                <RepeatButton.Template>
                                    <ControlTemplate>
                                        <Grid Width="10" Height="10" Background="Transparent">
                                            <Path Fill="White" Stretch="Fill" Height="8" Width="8" Data="M1384.6667,307.99984 L1399.6667,308.0005 1399.6667,331.34476 1424.5,331.67859 1424.5,347.01898 1399.8333,347.01932 1399.8333,371.69754 1384.8333,371.6972 1384.8333,346.85182 1359.5,346.85183 1359.5,331.84475 1384.8333,331.84475 1384.8333,307.83344" igPrim:XamlHelper.SnapsToDevicePixels="True"/>
                                        </Grid>
                                    </ControlTemplate>
                                </RepeatButton.Template>
                            </RepeatButton>
                            <TextBlock Text="{Binding ElementName=spreadSheet, Path=ZoomLevel, StringFormat={}{0}%}" Margin="5,0" Width="30" VerticalAlignment="Center"/>
                        </StackPanel>
                    </StatusBarItem>
                </StatusBar>
            </igwpf:RibbonWindowContentHost.StatusBar>
        </igwpf:RibbonWindowContentHost>

    </Grid>
</igwpf:XamRibbonWindow >
