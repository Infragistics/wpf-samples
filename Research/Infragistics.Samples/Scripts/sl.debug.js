var l = window.location.href; var isLoaded = false; if (window.addEventListener) { window.addEventListener("load", loaded, false) } else { window.attachEvent("onload", loaded) } function loaded() { if (isLoaded) { return } isLoaded = true; window.location.changed(l) } setInterval(function () { if (window.location.href != l) { l = window.location.href; window.location.changed(l) } }, 10); function loadSample(assembly) { var slPlugin = document.getElementById("slObject"); if (slPlugin) { try { __param_source = assembly; var p = $(slPlugin).parent(); p.empty(); var __sl = "<object id='slObject' data='data:application/x-silverlight-2,' type='application/x-silverlight-2' width='100%' height='100%'><param name='source' value='" + assembly + "' /><param name='onError' value='onSilverlightError' /><param name='background' value='white' /><param name='minRuntimeVersion' value='" + __param_minRuntimeVersion + "' /><param name='windowless' value='false' /><param name='autoUpgrade' value='true' /><param name='culture' value='" + __culture + "'/><a href='http://go.microsoft.com/fwlink/?LinkID=149156&amp;v=5.0.61118.0' style='text-decoration: none'><img id='fallbackImage' src='http://go.microsoft.com/fwlink/?LinkId=161376' alt='Get Microsoft Silverlight' style='border-style: none; width: 100%; height: 100%;' /></a></object><iframe id='_sl_historyFrame' style='visibility: hidden; height: 0px; width: 0px;border: 0px'></iframe>"; if ($.browser.webkit) { setTimeout(function () { p.html(__sl) }, 500) } else { p.html(__sl) } } catch (e) { console.log(e.toString()) } } } window.location.changed = function (e) { if (typeof (source) == "undefined") { return null } var hash = new String(e).indexOf("#"); if (hash < 0) { return } var p = new String(e).substring(hash + 1); for (i = 0; i < source.length; i++) { if (source[i].url == p) { if (source[i].xap.toLowerCase() != __param_source.toLowerCase()) { loadSample(source[i].xap) } if (!silverlightInstalled) { CallGetNonSilverlightSampleInformation(escape(document.location.href)) } else { CallSampleInformationService(source[i].sid) } break } } selectMenuItem(document.location.href.replace(document.location.protocol + "//" + document.location.host, "")) }; function updateTitle() { document.title = $("#titleContainer").html(); } function getSLSamplePath(seoName) { for (i = 0; i < source.length; i++) { if (source[i].url == seoName) { return source[i].path } } } function onSampleLoaded(sample) { } function onSourceDownloadProgressChanged(sender, eventArgs) { sender.findName("Loading").Text = loadedLocalizedString(); sender.findName("progressBar").Width = eventArgs.progress * (sender.findName("progressBarBackground").Width - 2) } function onSourceDownloadComplete(sender, eventArgs) { sender.findName("Loading").Text = loadedLocalizedString(); sender.findName("progressBar").Width = (sender.findName("progressBarBackground").Width - 2) } function selectMenuItem(href) { try { $("ul.leftNavLinks.cleanUL > li > a[href='" + href + "']").trigger("click") } catch (e) { } }; function updateTitle(){document.title=$("#titleContainer").html();}